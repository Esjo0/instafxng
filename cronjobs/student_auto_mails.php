<?php
set_include_path('/home/tboy9/public_html/init/');
require_once 'initialize_general.php';

$my_subject_1a = "So Nice to Meet You [NAME]";
$my_message_1a =
<<<MAIL
<p>Dear [NAME],</p>
<p>It's been 10 days since you started the Forex Money Maker course.</p>
<p>You are making notable progress and I'm super proud of you.</p>
<p>Now is not the time to relax at all. You've just started and you have some more lessons to take.</p>
<p>Get right on it [NAME]. <a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here</a> to pick up from where you left off.</p>
<p>The course you are currently on is not an end itself, It's the means to an end.</p>
<p>You are on a journey to making consistent income from Forex trading and this is where it begins.</p>
<p>Don't forget to <a href="http://bit.ly/2iExTpN" title="Click to continue your training">click here</a> to continue where you stopped.</p>
<p>See you at the other end.</p>
MAIL;

$my_subject_1b = "Don't be like Tare ...";
$my_message_1b =
<<<MAIL
<p>Dear [NAME],</p>
<p>The main purpose of forex trading is to make more money.</p>
<p>You probably wonder sometimes, how does this training translates to money for me?</p>
<p>It really does and I'll explain that to you shortly.</p>
<p>Tare has heard a lot about Forex trading, how many Nigerians are earning in foreign currencies by trading Forex.</p>
<p>As soon as he gets the opportunity to trade Forex, he jumped on it! He was thrilled and went ahead to open an account and trade.</p>
<p>He couldn't wait, he just wanted to get to it immediately so he funded his account and after placing a few trades, he lost all his initial capital.</p>
<p>What happened to Tare? He thought Forex was a get rich quick scheme and he didn't take his time to learn how to trade before he started trading.</p>
<p>The truth: Forex trading is no joke so it's important that you gain adequate knowledge of how to trade in the Forex market with lots of profits.</p>
<p>Like every business, it's important to learn the ropes of Forex trading before starting or committing your funds to it and this is what this training offers.</p>
<p>Many of the clients who started the training have gone ahead and are already making money from Forex trading.</p>
<p>Don't put money on the table [NAME], <a href="http://bit.ly/2iExTpN" title="Click to continue your training">click here</a> to continue now.</p>
MAIL;

$my_subject_1c = "Are you losing money?";
$my_message_1c =
<<<MAIL
<p>Carrie Wilkerson once said, 'The longer you're not taking action, the more money you're losing.'</p>
<p>Is this true [NAME]?</p>
<p>Everyone has a dream to live full and free; live in the best of houses, travel around the world, have enough time to spend with the people they love, the list goes on...</p>
<p>Let's face it, will everyone be rich and achieve this goals?</p>
<p>Not at all and the reason is not far-fetched.</p>
<p>The measure of your success will be to the degree which you will stretch yourself.</p>
<p>It's true [NAME], If you give 50% attention and time to things you do, you won't get 200% result from it.</p>
<p>When the input is little, the output will equally be small. This is one rule of thumb that holds true for everyone.</p>
<p>If you want the best things of life and you really want to live your dreams, you need to give things your 100% so you can get great results.</p>
<p>Don't miss this chance to make more money from a side business that is hassle free.</p>
<p>You're on your way to making steady profits from Forex trading, don't stop now.</p>
<p><a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here to continue from where you stopped</a> so you can join the league of extra ordinary achievers making steady profits from Forex trading.</p>
<p>Click <a href="http://bit.ly/2iExTpN" title="Click to continue your training">here</a> to get in immediately!</p>
MAIL;

$my_subject_1d = "You're not Alone [NAME]";
$my_message_1d =
<<<MAIL
<p>Hello there,</p>
<p>How are you doing today?</p>
<p>It's been a while since you last checked into your training portal.</p>
<p>I guess you have been very busy.</p>
<p>Don't I understand? I really do.</p>
<p>There are only 24 hours in a day and it's not enough to do all that we have to do within the day.</p>
<p>A quote from an unknown author says... â€˜Many things aren't equal but everyone gets the same 24 hours a day, 7 days a week. We make time for what we truly want.'</p>
<p>[NAME], how about creating time to go through the training so you can start generating income from Forex trading right after the training.</p>
<p>With the current Nigeria economy, it's has become increasingly difficult to thrive on just one source of income.</p>
<p>Ready to fire that dream of having more than enough money again? Let's help you achieve your goal!</p>
<p><a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here to go to class right away</a>.</p>
MAIL;

$my_subject_2a = "Think Profit, Think Forex!";
$my_message_2a =
<<<MAIL
<p>Hello [NAME],</p>
<p>How have you been?</p>
<p>Think of any business that allows you to profit in two ways, think Forex trading!</p>
<p>As you know, the Forex market is the biggest market in the world and the stock market cannot be compared to it.</p>
<p>In the stock market, you can only buy shares and get dividends when the stock goes on a profit and if it goes on a loss...</p>
<p>The rest is history.</p>
<p>Forex certainly has better options since you can make profit in two ways; when you buy and when you sell.</p>
<p>Does this sound new? It's actually true and you're getting to the part where you get to learn how to do this.</p>
<p>Don't stop now [NAME]. <a href="http://bit.ly/2iExTpN" title="Click to continue your training">click here</a> to pick up where you left off.</p>
MAIL;

$my_subject_2b = "The Forex Market has High Liquidity, Here's Why";
$my_message_2b =
<<<MAIL
<p>Hello [NAME],</p>
<p>Yesterday, someone asked me, when you say the Forex market has high liquidity, what does it mean?</p>
<p>Now, this is a very interesting question and I thought to share the answer to this question with you so you can understand how to make continued profit -from Forex trading.</p>
<p>When we say the Forex market has high liquidity, it means that it has many trades and is composed of many traders.</p>
<p>In lesson 1, you learnt that the Forex market is the biggest market in the world with over $5.3 trillion traded on a daily basis.</p>
<p>This means that a lot of traders' trade over $5.3 trillion daily in the Forex market.</p>
<p>With this, it means that you can make a whole lot of money trading Forex.</p>
<p>As long as you gain adequate knowledge of Forex trading and you know how to trade Forex of course!</p>
<p>Seen one reason you should continue your lessons? You can start taking your share of the 5.3 trillion dollars that is being traded daily in the Forex market right after the training!</p>
<p>Now go <a href="http://bit.ly/2iExTpN" title="Click to continue your training">right here</a> to continue from where you stopped  so you can join the traders who are consistently making profits from Forex trading.</p>
MAIL;

$my_subject_2c = "[NAME], You Deserve Some Accolades and Extra Cash too";
$my_message_2c =
<<<MAIL
<p>Dear [NAME],</p>
<p>I get it! You're very busy!</p>
<p>You probably have a 9-5 job, a family you need to spend ample time with or you're even a student who has to study hard to pass in flying colours.</p>
<p>Or are you an entrepreneur? Makes it tougher!</p>
<p>You have to work night and day to make your enterprise successful.</p>
<p>You sure deserve some accolades.</p>
<p>What if you can make an extra $500 a week or more coupled with what you do, would be able to create time for that side hustle?</p>
<p>I bet you will! The Forex market is quite dynamic and is always open 24 hours a day, 5 days a week.</p>
<p>This gives you the opportunity to choose the time convenient for you to make money within 24 hours.</p>
<p>Imagine how much money you would have made by now if only you had completed your lessons and have started trading.</p>
<p>It's not too late yet! <a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here</a> to go to class [NAME].</p>
<p>Your training portal is warming up to receive you.</p>
MAIL;

$my_subject_2d = "The dollar is the king in the Forex Market... Here's why";
$my_message_2d =
<<<MAIL
<p>Dear [NAME],</p>
<p>When we talk about the forex market, we are simply talking dollars.</p>
<p>A trainee sent me a message yesterday.</p>
<p>He said, we are Nigerians taking this course, why can't the money used in trading be demonstrated in our Local currency...</p>
<p>You may ask, 'What's the essence of mentioning dollars when we are Nigerians spending Naira?'</p>
<p>Now that's the beauty of Forex trading. It allows you to trade and earn in foreign currencies while you are in Nigeria.</p>
<p>The United States economy is the largest economy in the world while the U.S dollar is the reserve currency of the world.</p>
<p>It's also best to know that the United states has the largest and most liquid financial markets in the world.</p>
<p>In the Forex market, the US dollars makes up one half of every major currency pair that is being traded.</p>
<p>[NAME], you've got to adjust to making money in foreign currencies buddy!</p>
<p>The dollar is truly the king in the Forex market.</p>
<p>Are you ready to start earning in dollars? You can't be too late!</p>
<p>Go <a href="http://bit.ly/2iExTpN" title="Click to continue your training">here</a> to complete your lessons and you'd be ready to start raking in your own share of dollars.</p>
<p>Don't forget to leave a message in the message box if you have a question or an enquiry.</p>
<p>I'll be sure to send you a response immediately.</p>
<p>See you at the other end.</p>
MAIL;

$my_subject_3a = "Here's One Must Know Tip for you";
$my_message_3a =
<<<MAIL
<p>Hello [NAME],</p>
<p>How are you doing?</p>
<p>In lesson 2, we broke down the meaning of Forex trading and even compared it with changing naira to dollars vice versa from the Aboki guys.</p>
<p>Like you learnt in that lesson. This is the definition of Forex trading in its most basic form.</p>
<p>Trust me, what goes on in the Forex market is much more than the explanation and that's the reason this course was created, <a href="http://bit.ly/2iExTpN" title="Click to continue your training">to help you learn how to trade Forex profitably</a> so you can become one of the successful traders who make profits from the Forex market.</p>
<p>The most important part of being a Forex trader is actually the process of getting sufficient information needed to trade profitably.</p>
<p>Take a step further [NAME].</p>
<p>You are currently on lesson 2 and you have some more lessons till you start earning from Forex.</p>
<p>Don't dillydally! <a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here to proceed from where you stopped.</a></p>
MAIL;

$my_subject_3b = "Success: are you determined?";
$my_message_3b =
<<<MAIL
<p>Hello [NAME],</p>
<p>I told you that the opportunities available to you in the Forex market are limitless and this is why I'm interested in showing you the better way.</p>
<p>Do you sometimes wonder why we say the Forex market is the biggest market in the world?</p>
<p>Well, that's right.</p>
<p>You need a lot of money to start trading in the Forex market but you don't have to have a lot of money to trade Forex profitably.</p>
<p>Does that seem a little confusing? Not to worry, I'll make it clearer shortly.</p>
<p>Before now, Forex trading was for certain individuals who had access to large funds and could put this funds into the market and for financial institutions like banks.</p>
<p>Shouldn't you be able to trade Forex in order to make more money too? You definitely should!</p>
<p>This is the reason why leverage was introduced to Forex trading so that everyone interested in trading Forex can access the Forex market irrespective of the amount they can fund their accounts with.</p>
<p>This means that, ordinarily, if you fund your account with $100, this amount is too small to trade the Forex market.</p>
<p>However, you don't have to worry about this anymore as leverage allows you to have ample funds to trade so you can have more profit to make.</p>
<p>Now if you fund $100 and use a leverage of 1:100, it means that you will be able to trade with 100x100= $10, 000 instead of the little $100 you funded.</p>
<p>The leverage is always there for your use anytime any day.</p>
<p>Isn't this amazing? I know, it is.</p>
<p>This is one of the reasons you need to complete the Forex money maker course so you can start making money in no time.</p>
<p><a href="http://bit.ly/2iExTpN" title="Click to continue your training">You can access the course here.</a></p>
<p>Do you have any more question on leverage? Kindly send your question as a response to this mail.</p>
MAIL;

$my_subject_3c = "Where Have you been, [NAME]";
$my_message_3c =
<<<MAIL
<p>Dear [NAME],</p>
<p>Where have you been? Still on this planet or you visited Mars?</p>
<p>Did you bring something on your return trip?</p>
<p>Just kidding [NAME].</p>
<p>Seriously, it's been a while you logged into your training portal to continue your lessons</p>
<p>I'm really surprised? All your drive for an extra source of income, has it gone cold just like that?</p>
<p>Don't let it go cold! Think of all the possibilities available to you with just a lirru (little) something on the side.</p>
<p>Think of how you'd raise your standard of living and of course, how well you'd be able to help some other people.</p>
<p>Keep it moving [NAME]. <a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here to continue from where you stopped.</a></p>
MAIL;

$my_subject_3d = "Know this About Forex Traders";
$my_message_3d =
<<<MAIL
<p>Dear [NAME],</p>
<p>Truth be told, Forex traders are smart!</p>
<p>Trading Forex allows you to be vast and to know something about countries you probably would never be interested in if you don't trade Forex.</p>
<p>Forex trading allows you to be in the know of the things going on in a country and how that affects their economy.</p>
<p>You may ask, how does this concern me?</p>
<p>Since trading a country's currency is like buying a share in a particular country, it's important to study the market's opinion of the country's economy so you know how profitable your trades can be.</p>
<p>Do you now see why it's very crucial to gain adequate knowledge of Forex trading?</p>
<p>Make notable progress [NAME], <a href="http://bit.ly/2iExTpN" title="Click to continue your training">click here</a> to continue from where you stopped.</p>
<p>The next lesson details the numerous benefits the Forex market has for you.</p>
<p>Click <a href="http://bit.ly/2iExTpN" title="Click to continue your training">here</a> to continue right away.</p>
MAIL;

$my_subject_4a = "It's been Long I saw you [NAME]";
$my_message_4a =
<<<MAIL
<p>It's been a while [NAME]</p>
<p>How have you been?</p>
<p>It is a known fact that knowledge is very important for forex traders as the more knowledge you get the clearer and easy Forex trading becomes.</p>
<p>Paul Tudor Jones once said, "The secret to being successful from a trading perspective is to have an indefatigable and an undying and unquenchable thirst for information and knowledge."</p>
<p>This is very apt [NAME] as professional traders testify that the more information they acquire, the more profitable their trades become.</p>
<p>This is what Fredrick, a trainee who partook of the Forex academy said about the training.</p>

<p style="text-align: center">I sincerely appreciate insta-forex Nigeria for the online training.</p>
<p style="text-align: center">It was indeed an eye opener,because I didn't know anything about forex trading but the online training opened my eyes.</p>
<p style="text-align: center">It was impactful...</p>

<p>This could be you but you haven't taken the necessary step to advance your education on how to trade Forex profitably.</p>
<p>Don't leave money on the table [NAME]. Take a step further.</p>
<p><a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here to make payment and start the Forex money maker course.</a></p>
<p>Lots of value awaits!</p>
MAIL;

$my_subject_4b = "[NAME], Don't You Dare!";
$my_message_4b =
<<<MAIL
<p>Dear [NAME],</p>
<p>Most people wonder, why do I have to go through training before I start trading.</p>
<p>Can't I just go ahead to start trading?</p>
<p>My advice: Don't you dare!</p>
<p>I remember when my popman (Popman means Father) bought his first phone.</p>
<p>Those days, phone was a luxury and a few people could afford a Nokia 3310 phone.</p>
<p>It came with a manual and he took his time to read the important part of the manual to avoid stories that touch which could arise as a matter of mishandling.</p>
<p>This is very similar to Forex trading.</p>
<p>Would you like to make steady profits from forex without turning your trading platform to a casino and avoid gambling?</p>
<p>Then this is where you should be right now! The Forex academy of course!</p>
<p>You've been gone for too long. Even your training portal misses you and can't wait to have you back.</p>
<p>This is the better way [NAME]. Hurry, your lesson awaits.</p>
<p><a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here to go to class!</a></p>
MAIL;

$my_subject_4c = "Imagine What It Feel Likes to Make Steady Profit...";
$my_message_4c =
<<<MAIL
<p>Dear [NAME],</p>
<p>Have you ever thought about doing a job that allows you to have and spend quality time with the people you love?</p> 
<p>As much as it is important to make money, it is equally important to spend quality time with the people you love, isn't it?</p>
<p>That's right!</p>
<p>With Forex trading, you can make money from anywhere you are in the world.</p> 
<p>This simply means that if you would rather spend a day with the people you love while making money on the side, Forex trading makes it possible.</p>
<p>A client once shared with us, how he would wake in the morning, read a few forex news, study the market from the previous day, then place pending orders with stop loss and take profit targets.</p>
<p>At the end of the day, some of the pending orders would have triggered, closing on profits.</p>
<p>This client makes more money and spends a lot of time with friends and families doing other things.</p>
<p>How was he able to achieve this? He took our training in the past and had learnt all he needs to keep making sustainable and steady income from Forex trading.</p>
<p>[NAME], choose the better life today! Grasp this lifetime opportunity to make more money wherever you are!</p>
<p><a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here to pick up where you left off and start your journey to consistent income.</a></p>
MAIL;

$my_subject_4d = "[NAME], Is it a Love/Hate Affair?";
$my_message_4d =
<<<MAIL
<p>Dear [NAME],</p>
<p>Did you get discouraged from Forex trading from a person or persons who had a time trading Forex because of their refusal to gain adequate knowledge of the Forex market and had done all they could to dissuade you from trading Forex?</p>
<p>Well, a lot of people try to dissuade other people like you from succeeding where they failed, they tell how impossible it is to make it and you might gulp their lie down and allow their own reality be yours instead of living out your own reality.</p> 
<p>It's true that Forex trading is not a child's play neither is it a form of gambling where you expect to do little to get more if luck smiles on you.</p>
<p>Kevin Ngo, an African writer once said that you have to make time out to create the life you want.</p>
<p>The opportunities available to you in Forex trading are limitless, however, you have to invest a little of your time daily in order to acquire the knowledge you need so you can make steady income from the market.</p> 
<p>[NAME], you have some lessons left.</p>
<p><a href="http://bit.ly/2iExTpN" title="Click to continue your training">Click here to continue from where you stopped.</a></p>
<p>Don't forget to choose the life of your dreams, create your own reality and live your life to the fullest!</p>
MAIL;



function student_auto_mail_template($core_msg) {

$my_message_template =
<<<MAIL
<div style="background-color: #F3F1F2">
    <div style="max-width: 80%; margin: 0 auto; padding: 10px; font-size: 14px; font-family: Verdana;">
        <img src="https://instafxng.com/images/ifxlogo.png" />
        <hr />
        <div style="background-color: #FFFFFF; padding: 15px; margin: 5px 0 5px 0;">

            $core_msg

            <br /><br />
            <p>Best Regards,</p>

            <p>Your friend,<br />
            Mercy,<br />
            Client Relations Manager.</p>
            <p>InstaFxNg,<br />
                www.instafxng.com</p>
            <br /><br />
        </div>
        <hr />
        <div style="background-color: #EBDEE9;">
            <div style="font-size: 11px !important; padding: 15px;">
                <p style="text-align: center"><span style="font-size: 12px"><strong>We're Social</strong></span><br /><br />
                    <a href="https://facebook.com/InstaForexNigeria"><img src="https://instafxng.com/images/Facebook.png"></a>
                    <a href="https://twitter.com/instafxng"><img src="https://instafxng.com/images/Twitter.png"></a>
                    <a href="https://www.instagram.com/instafxng/"><img src="https://instafxng.com/images/instagram.png"></a>
                    <a href="https://www.youtube.com/channel/UC0Z9AISy_aMMa3OJjgX6SXw"><img src="https://instafxng.com/images/Youtube.png"></a>
                    <a href="https://linkedin.com/company/instaforex-ng"><img src="https://instafxng.com/images/LinkedIn.png"></a>
                </p>
                <p><strong>Head Office Address:</strong> TBS Place, Block 1A, Plot 8, Diamond Estate, Estate Bus-Stop, LASU/Isheri road, Isheri Olofin, Lagos.</p>
                <p><strong>Lekki Office Address:</strong> Block A3, Suite 508/509 Eastline Shopping Complex, Opposite Abraham Adesanya Roundabout, along Lekki - Epe expressway, Lagos.</p>
                <p><strong>Office Number:</strong> 08028281192</p>
                <br />
            </div>
            <div style="font-size: 10px !important; padding: 15px; text-align: center;">
                <p>This email was sent to you by Instant Web-Net Technologies Limited, the
                    official Nigerian Representative of Instaforex, operator and administrator
                    of the website www.instafxng.com</p>
                <p>To ensure you continue to receive special offers and updates from us,
                    please add support@instafxng.com to your address book.</p>
            </div>
        </div>
    </div>
</div>
MAIL;

    return $my_message_template;
}

function student_auto_mail_query($query_type, $day_value) {

    $today = date('Y-m-d');

    switch($query_type) {
        case 1:
            $query = "SELECT u.first_name, u.email
                FROM user_edu_exercise_log AS ueel
                INNER JOIN user AS u ON ueel.user_code = u.user_code
                INNER JOIN account_officers AS ao ON u.attendant = ao.account_officers_id
                INNER JOIN admin AS a ON ao.admin_code = a.admin_code
                LEFT JOIN user_edu_fee_payment AS uefp ON ueel.user_code = uefp.user_code
                WHERE (DATEDIFF('$today', STR_TO_DATE(ueel.created, '%Y-%m-%d')) = $day_value) AND ueel.lesson_id = 1 AND uefp.user_code IS NULL AND u.user_code NOT IN
                (
                    SELECT u.user_code
                    FROM user_edu_exercise_log AS ueel
                    INNER JOIN user AS u ON ueel.user_code = u.user_code
                    INNER JOIN account_officers AS ao ON u.attendant = ao.account_officers_id
                    INNER JOIN admin AS a ON ao.admin_code = a.admin_code
                    LEFT JOIN user_edu_fee_payment AS uefp ON ueel.user_code = uefp.user_code
                    WHERE ueel.lesson_id IN (2, 3, 4, 5) AND uefp.user_code IS NULL
                )
                GROUP BY ueel.user_code ORDER BY u.academy_signup DESC, u.last_name ASC";
            break;
        case 2:
            $query = "SELECT u.first_name, u.email
                FROM user_edu_exercise_log AS ueel
                INNER JOIN user AS u ON ueel.user_code = u.user_code
                INNER JOIN account_officers AS ao ON u.attendant = ao.account_officers_id
                INNER JOIN admin AS a ON ao.admin_code = a.admin_code
                LEFT JOIN user_edu_fee_payment AS uefp ON ueel.user_code = uefp.user_code
                WHERE (DATEDIFF('$today', STR_TO_DATE(ueel.created, '%Y-%m-%d')) = $day_value) AND ueel.lesson_id = 2 AND uefp.user_code IS NULL AND u.user_code NOT IN
                (
                    SELECT u.user_code
                    FROM user_edu_exercise_log AS ueel
                    INNER JOIN user AS u ON ueel.user_code = u.user_code
                    INNER JOIN account_officers AS ao ON u.attendant = ao.account_officers_id
                    INNER JOIN admin AS a ON ao.admin_code = a.admin_code
                    LEFT JOIN user_edu_fee_payment AS uefp ON ueel.user_code = uefp.user_code
                    WHERE ueel.lesson_id IN (3, 4, 5) AND uefp.user_code IS NULL
                )
                GROUP BY ueel.user_code ORDER BY u.academy_signup DESC, u.last_name ASC";
            break;
        case 3:
            $query = "SELECT u.first_name, u.email
                FROM user_edu_exercise_log AS ueel
                INNER JOIN user AS u ON ueel.user_code = u.user_code
                INNER JOIN account_officers AS ao ON u.attendant = ao.account_officers_id
                INNER JOIN admin AS a ON ao.admin_code = a.admin_code
                LEFT JOIN user_edu_fee_payment AS uefp ON ueel.user_code = uefp.user_code
                WHERE (DATEDIFF('$today', STR_TO_DATE(ueel.created, '%Y-%m-%d')) = $day_value) AND ueel.lesson_id = 3 AND uefp.user_code IS NULL AND u.user_code NOT IN
                (
                    SELECT u.user_code
                    FROM user_edu_exercise_log AS ueel
                    INNER JOIN user AS u ON ueel.user_code = u.user_code
                    INNER JOIN account_officers AS ao ON u.attendant = ao.account_officers_id
                    INNER JOIN admin AS a ON ao.admin_code = a.admin_code
                    LEFT JOIN user_edu_fee_payment AS uefp ON ueel.user_code = uefp.user_code
                    WHERE ueel.lesson_id IN (4, 5) AND uefp.user_code IS NULL
                )
                GROUP BY ueel.user_code ORDER BY u.academy_signup DESC, u.last_name ASC";
            break;
        case 4:
            $query = "SELECT u.first_name, u.email
                FROM user_edu_exercise_log AS ueel
                INNER JOIN user AS u ON ueel.user_code = u.user_code
                INNER JOIN account_officers AS ao ON u.attendant = ao.account_officers_id
                INNER JOIN admin AS a ON ao.admin_code = a.admin_code
                LEFT JOIN user_edu_fee_payment AS uefp ON ueel.user_code = uefp.user_code
                WHERE (DATEDIFF('$today', STR_TO_DATE(ueel.created, '%Y-%m-%d')) = $day_value) AND ueel.lesson_id = 5 AND uefp.user_code IS NULL AND u.user_code NOT IN
                (
                    SELECT u.user_code
                    FROM user_edu_exercise_log AS ueel
                    INNER JOIN user AS u ON ueel.user_code = u.user_code
                    INNER JOIN account_officers AS ao ON u.attendant = ao.account_officers_id
                    INNER JOIN admin AS a ON ao.admin_code = a.admin_code
                    LEFT JOIN user_edu_fee_payment AS uefp ON ueel.user_code = uefp.user_code
                    WHERE ueel.lesson_id IN (4) AND uefp.user_code IS NULL
                )
                GROUP BY ueel.user_code ORDER BY u.academy_signup DESC, u.last_name ASC";
            break;
        default:
            $query = "";
    }

    return $query;
}

function student_auto_mail_send($query, $my_subject_raw, $my_message_raw) {
    global $db_handle;
    global $system_object;

    $result = $db_handle->runQuery($query);
    $fetched_data = $db_handle->fetchAssoc($result);

    foreach ($fetched_data as $row) {
        $client_name = ucwords(strtolower(trim($row['first_name'])));
        $client_email = strtolower(trim($row['email']));

        $my_subject = $my_subject_raw;
        $my_message = $my_message_raw;

        // Replace [NAME] with clients full name
        $my_message_new = str_replace('[NAME]', $client_name, $my_message);
        $my_subject_new = str_replace('[NAME]', $client_name, $my_subject);

        $system_object->send_email($my_subject_new, $my_message_new, $client_email, $client_name);
    }

    return true;
}

//TODO: Refactor and make it dynamic

// 10 day interval
$interval_1 = 10;

$query_1a = student_auto_mail_query(1, $interval_1);
$get_mail_1a = student_auto_mail_template($my_message_1a);
$send_message_1a = student_auto_mail_send($query_1a, $my_subject_1a, $get_mail_1a);

$query_2a = student_auto_mail_query(2, $interval_1);
$get_mail_2a = student_auto_mail_template($my_message_2a);
$send_message_2a = student_auto_mail_send($query_2a, $my_subject_2a, $get_mail_2a);

$query_3a = student_auto_mail_query(3, $interval_1);
$get_mail_3a = student_auto_mail_template($my_message_3a);
$send_message_3a = student_auto_mail_send($query_3a, $my_subject_3a, $get_mail_3a);

$query_4a = student_auto_mail_query(4, $interval_1);
$get_mail_4a = student_auto_mail_template($my_message_4a);
$send_message_4a = student_auto_mail_send($query_4a, $my_subject_4a, $get_mail_4a);

// 20 day interval
$interval_2 = 20;

$query_1b = student_auto_mail_query(1, $interval_2);
$get_mail_1b = student_auto_mail_template($my_message_1b);
$send_message_1b = student_auto_mail_send($query_1b, $my_subject_1b, $get_mail_1b);

$query_2b = student_auto_mail_query(2, $interval_2);
$get_mail_2b = student_auto_mail_template($my_message_2b);
$send_message_2b = student_auto_mail_send($query_2b, $my_subject_2b, $get_mail_2b);

$query_3b = student_auto_mail_query(3, $interval_2);
$get_mail_3b = student_auto_mail_template($my_message_3b);
$send_message_3b = student_auto_mail_send($query_3b, $my_subject_3b, $get_mail_3b);

$query_4b = student_auto_mail_query(4, $interval_2);
$get_mail_4b = student_auto_mail_template($my_message_4b);
$send_message_4b = student_auto_mail_send($query_4b, $my_subject_4b, $get_mail_4b);

// 30 day interval
$interval_3 = 30;

$query_1c = student_auto_mail_query(1, $interval_3);
$get_mail_1c = student_auto_mail_template($my_message_1c);
$send_message_1c = student_auto_mail_send($query_1c, $my_subject_1c, $get_mail_1c);

$query_2c = student_auto_mail_query(2, $interval_3);
$get_mail_2c = student_auto_mail_template($my_message_2c);
$send_message_2c = student_auto_mail_send($query_2c, $my_subject_2c, $get_mail_2c);

$query_3c = student_auto_mail_query(3, $interval_3);
$get_mail_3c = student_auto_mail_template($my_message_3c);
$send_message_3c = student_auto_mail_send($query_3c, $my_subject_3c, $get_mail_3c);

$query_4c = student_auto_mail_query(4, $interval_3);
$get_mail_4c = student_auto_mail_template($my_message_4c);
$send_message_4c = student_auto_mail_send($query_4c, $my_subject_4c, $get_mail_4c);

// 40 day interval
$interval_4 = 40;

$query_1d = student_auto_mail_query(1, $interval_4);
$get_mail_1d = student_auto_mail_template($my_message_1d);
$send_message_1d = student_auto_mail_send($query_1d, $my_subject_1d, $get_mail_1d);

$query_2d = student_auto_mail_query(2, $interval_4);
$get_mail_2d = student_auto_mail_template($my_message_2d);
$send_message_2d = student_auto_mail_send($query_2d, $my_subject_2d, $get_mail_2d);

$query_3d = student_auto_mail_query(3, $interval_4);
$get_mail_3d = student_auto_mail_template($my_message_3d);
$send_message_3d = student_auto_mail_send($query_3d, $my_subject_3d, $get_mail_3d);

$query_4d = student_auto_mail_query(4, $interval_4);
$get_mail_4d = student_auto_mail_template($my_message_4d);
$send_message_4d = student_auto_mail_send($query_4d, $my_subject_4d, $get_mail_4d);

if($db_handle) { $db_handle->closeDB(); mysqli_close($db_handle); }